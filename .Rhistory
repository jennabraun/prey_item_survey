library(XLConnect)
library(XLConnect)
library(ggplot2)
wb <- loadWorkbook("Raw Data/arthropods.xslx")
wb <- loadWorkbook("Raw Data/arthropods.xlsx")
wb <- loadWorkbook("Raw Data/Arthropod_data.xlsx")
pods <- readWorksheet(wb, Identifications)
pods <- readWorksheet(wb, "Identifications")
View(pods)
summary <- pods %>% group_by(site, month, method) %>% count()
library(dplyr)
summary <- pods %>% group_by(site, month, method) %>% count()
View(summary)
summary <- pods %>% group_by(site, month, method, rep) %>% count()
View(summary)
summary <- pods %>% group_by(site, month, microsite, method, rep)
pods$repID <- paste(pods$site, pods$month, pods$day, pods$mic,pods$microsite, pods$method)
pods$repID <- paste(pods$site, pods$month, pods$day, pods$microsite, pods$method, pods$rep)
summary <- pods %>% group_by(site, month, day, microsite, methods) %>% count(rep)
summary <- pods %>% group_by(site, month, day, microsite, method) %>% count(rep)
summary <- pods %>% group_by(site, month, day, microsite, method) %>% count(rep)
summary <- pods %>% group_by(site, month, day, microsite, method, rep) %>% distinct() %>% count(rep)
summary <- pods %>% group_by(site, month, day, microsite, method) %>% n_distinct(rep)
summary <- pods %>% group_by(site, month, day, microsite, method) %>% n_distinct()
summary <- pods %>% group_by(site, month, day, microsite, method) %>% count(rep)
summary <- pods %>% group_by(site, month, day, microsite, method) %>% mutate(rep_n = n_distinct(rep))
summary <- pods %>% group_by(site, month, day, microsite, method, rep) %>% mutate(rep_n = n_distinct(method))
summary <- pods %>% group_by(site, month, day, microsite, method) %>% summarise(n_distinct(rep))
summary <- pods %>% group_by(site, month, day, microsite, method) %>% summarise(n_distinct(rep), sum = sum(Quantity))
summary <- summary %>% mutate(month_num = ifelse(month == "July"), 1, ifelse(month == "Aug"), 2, 3))
summary <- summary %>% mutate(month_num = ifelse(month == "July"), 1, ifelse(month == "Aug"), 2, 3)
summary <- summary %>% mutate(month_num = ifelse(month == "July"), 1, (ifelse(month == "Aug"), 2, 3))
summary <- summary %>% mutate(month_num = case_when(month == "July" ~ 1, month == "Aug" ~ 2, month == "Sept" ~ 3))
summary <- summary %>% ungroup() %>% mutate(month_num = case_when(month == "July" ~ 1, month == "Aug" ~ 2, month == "Sept" ~ 3))
count(summary$month)
n(summary$month)
count(summary, month)
pods$month <- gsub(" ","", pods$month)
summary <- pods %>% group_by(site, month, day, microsite, method) %>% summarise(n_distinct(rep))
count(summary, month)
summary <- summary %>% ungroup() %>% mutate(month_num = case_when(month == "July" ~ 1, month == "Aug" ~ 2, month == "Sept" ~ 3))
count(summary, month)
sum(summary$`n_distinct(rep)`)
summary <- summary[order(site, month_num, method, microsite, rep)]
summary <- summary[order(site, month_num, method, microsite, rep)]
summary <- summary[order(site, month_num, method, microsite, rep),]
summary <- summary %>% ungroup()
summary <- summary[order(site, month_num, method, microsite, rep),]
summary <- summary[order(summary$site, month_num, method, microsite, rep),]
summary <- summary[order(summary$site, summary$month_num, summary$method, summary$microsite, summary$rep),]
summary <- pods %>% group_by(site, month, microsite, method) %>% summarise(n_distinct(rep))
summary <- summary %>% ungroup() %>% mutate(month_num = case_when(month == "July" ~ 1, month == "Aug" ~ 2, month == "Sept" ~ 3))
summary <- summary %>% ungroup()
summary <- summary[order(summary$site, summary$month_num, summary$method, summary$microsite, summary$rep),]
str(summary)
summary <- summary[order(summary$site, summary$month_num, summary$method, summary$microsite, summary$rep),]
summary <- summary[order(summary$site, summary$month_num, summary$method, summary$microsite),]
count(summary, site)
library(XLConnect)
library(ggplot2)
library(dplyr)
pods <- readWorksheetFromFile("Raw Data/Arthropod_data.xlsx", "Identifications")
pods$repID <- paste(pods$site, pods$month, pods$day, pods$microsite, pods$method, pods$rep)
pods$month <- gsub(" ","", pods$month)
summary <- pods %>% group_by(site, month, microsite, method) %>% summarise(n_distinct(rep))
summary <- summary %>% ungroup() %>% mutate(month_num = case_when(month == "July" ~ 1, month == "Aug" ~ 2, month == "Sept" ~ 3))
summary <- summary %>% ungroup()
summary <- summary[order(summary$site, summary$month_num, summary$method, summary$microsite),]
count(summary, site)
summary <- rename(summary, samples = "n_distinct(rep)")
summary <- select(summary, -month_num)
