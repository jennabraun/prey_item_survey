library(XLConnect)
library(XLConnect)
library(ggplot2)
wb <- loadWorkbook("Raw Data/arthropods.xslx")
wb <- loadWorkbook("Raw Data/arthropods.xlsx")
wb <- loadWorkbook("Raw Data/Arthropod_data.xlsx")
pods <- readWorksheet(wb, Identifications)
pods <- readWorksheet(wb, "Identifications")
View(pods)
summary <- pods %>% group_by(site, month, method) %>% count()
library(dplyr)
summary <- pods %>% group_by(site, month, method) %>% count()
View(summary)
summary <- pods %>% group_by(site, month, method, rep) %>% count()
View(summary)
summary <- pods %>% group_by(site, month, microsite, method, rep)
pods$repID <- paste(pods$site, pods$month, pods$day, pods$mic,pods$microsite, pods$method)
pods$repID <- paste(pods$site, pods$month, pods$day, pods$microsite, pods$method, pods$rep)
summary <- pods %>% group_by(site, month, day, microsite, methods) %>% count(rep)
summary <- pods %>% group_by(site, month, day, microsite, method) %>% count(rep)
summary <- pods %>% group_by(site, month, day, microsite, method) %>% count(rep)
summary <- pods %>% group_by(site, month, day, microsite, method, rep) %>% distinct() %>% count(rep)
summary <- pods %>% group_by(site, month, day, microsite, method) %>% n_distinct(rep)
summary <- pods %>% group_by(site, month, day, microsite, method) %>% n_distinct()
summary <- pods %>% group_by(site, month, day, microsite, method) %>% count(rep)
summary <- pods %>% group_by(site, month, day, microsite, method) %>% mutate(rep_n = n_distinct(rep))
summary <- pods %>% group_by(site, month, day, microsite, method, rep) %>% mutate(rep_n = n_distinct(method))
summary <- pods %>% group_by(site, month, day, microsite, method) %>% summarise(n_distinct(rep))
summary <- pods %>% group_by(site, month, day, microsite, method) %>% summarise(n_distinct(rep), sum = sum(Quantity))
summary <- summary %>% mutate(month_num = ifelse(month == "July"), 1, ifelse(month == "Aug"), 2, 3))
summary <- summary %>% mutate(month_num = ifelse(month == "July"), 1, ifelse(month == "Aug"), 2, 3)
summary <- summary %>% mutate(month_num = ifelse(month == "July"), 1, (ifelse(month == "Aug"), 2, 3))
summary <- summary %>% mutate(month_num = case_when(month == "July" ~ 1, month == "Aug" ~ 2, month == "Sept" ~ 3))
summary <- summary %>% ungroup() %>% mutate(month_num = case_when(month == "July" ~ 1, month == "Aug" ~ 2, month == "Sept" ~ 3))
count(summary$month)
n(summary$month)
count(summary, month)
pods$month <- gsub(" ","", pods$month)
summary <- pods %>% group_by(site, month, day, microsite, method) %>% summarise(n_distinct(rep))
count(summary, month)
summary <- summary %>% ungroup() %>% mutate(month_num = case_when(month == "July" ~ 1, month == "Aug" ~ 2, month == "Sept" ~ 3))
count(summary, month)
sum(summary$`n_distinct(rep)`)
summary <- summary[order(site, month_num, method, microsite, rep)]
summary <- summary[order(site, month_num, method, microsite, rep)]
summary <- summary[order(site, month_num, method, microsite, rep),]
summary <- summary %>% ungroup()
summary <- summary[order(site, month_num, method, microsite, rep),]
summary <- summary[order(summary$site, month_num, method, microsite, rep),]
summary <- summary[order(summary$site, summary$month_num, summary$method, summary$microsite, summary$rep),]
summary <- pods %>% group_by(site, month, microsite, method) %>% summarise(n_distinct(rep))
summary <- summary %>% ungroup() %>% mutate(month_num = case_when(month == "July" ~ 1, month == "Aug" ~ 2, month == "Sept" ~ 3))
summary <- summary %>% ungroup()
summary <- summary[order(summary$site, summary$month_num, summary$method, summary$microsite, summary$rep),]
str(summary)
summary <- summary[order(summary$site, summary$month_num, summary$method, summary$microsite, summary$rep),]
summary <- summary[order(summary$site, summary$month_num, summary$method, summary$microsite),]
count(summary, site)
library(XLConnect)
library(ggplot2)
library(dplyr)
pods <- readWorksheetFromFile("Raw Data/Arthropod_data.xlsx", "Identifications")
pods$repID <- paste(pods$site, pods$month, pods$day, pods$microsite, pods$method, pods$rep)
pods$month <- gsub(" ","", pods$month)
summary <- pods %>% group_by(site, month, microsite, method) %>% summarise(n_distinct(rep))
summary <- summary %>% ungroup() %>% mutate(month_num = case_when(month == "July" ~ 1, month == "Aug" ~ 2, month == "Sept" ~ 3))
summary <- summary %>% ungroup()
summary <- summary[order(summary$site, summary$month_num, summary$method, summary$microsite),]
count(summary, site)
summary <- rename(summary, samples = "n_distinct(rep)")
summary <- select(summary, -month_num)
sum(as.numeric(pods$quantity))
library(XLConnect)
library(ggplot2)
library(dplyr)
active <- readWorksheetFromFile("Raw Data/Arthropod_data.xlsx", "Active")
active$repID <- paste(active$site, active$month, active$day, active$microsite, active$rep)
active$month <- gsub(" ","", active$month)
summary <- active %>% group_by(site, month, microsite, method) %>% summarise(n_distinct(rep))
View(summary)
sum(summary$samples)
knitr::kable(summary)
sum(active$quantity)
active$quantity <- as.numeric(active$quantity)
sum(active$quantity)
View(active)
sum(active$quantity, na.rm = TRUE)
order <- active %>% group_by(site, month, order) %>% summarise(sum(quantity, na.rm = TRUE))
View(order)
order <- active %>% group_by(site, order) %>% summarise(sum(quantity, na.rm = TRUE))
View(order)
order <- active %>% group_by(order) %>% summarise(sum(quantity, na.rm = TRUE))
ggplot(order, aes(quantity, order)) + geom_bar(stat = "identity")
order <- active %>% group_by(order) %>% summarise(sum = sum(quantity, na.rm = TRUE))
ggplot(order, aes(quantity, order)) + geom_bar(stat = "identity")
ggplot(order, aes(sum, order)) + geom_bar(stat = "identity")
library(XLConnect)
library(ggplot2)
library(dplyr)
active <- readWorksheetFromFile("Raw Data/Arthropod_data.xlsx", "Active")
active$repID <- paste(active$site, active$month, active$day, active$microsite, active$rep)
active$month <- gsub(" ","", active$month)
#calculations for mark
sum(active$quantity)
#calculations for mark
sum(as.numeric(active$quantity))
#calculations for mark
active <- active %>% group_by(order) %>% summarise(count = sum(Quantity))
#calculations for mark
active <- active %>% group_by(order) %>% summarise(count = sum(quantity))
#calculations for mark
active <- active %>% group_by(order) %>% summarise(Sum = sum(quantity))
#calculations for mark
active <- active %>% group_by(order) %>% summarise(abun = sum(quantity))
#calculations for mark
active <- active %>% group_by(order) %>% summarise(abun = sum(as.numeric(quantity)))
#calculations for mark
active <- active %>% group_by(order) %>% summarise(abun = sum(as.numeric(quantity), na.rm = TRUE))
active <- readWorksheetFromFile("Raw Data/Arthropod_data.xlsx", "Active")
active$repID <- paste(active$site, active$month, active$day, active$microsite, active$rep)
active$month <- gsub(" ","", active$month)
#calculations for mark
active$
active <- active %>% group_by(order) %>% summarise(abun = sum(as.numeric(quantity), na.rm = TRUE))
active <- active %>% group_by(order) %>% summarise(abun = sum(as.numeric(quantity), na.rm = TRUE))
pits <- readWorksheetFromFile("Raw Data/Arthropod_data.xlsx", "Pitfall")
pits <- readWorksheetFromFile("Raw Data/Arthropod_data.xlsx", "Pitfalls")
pitcount <- pits %>% group_by(order) %>% summarise(abun = sum(as.numeric(quantity), na.rm = TRUE))
View(pitcount)
mal <-readWorksheetFromFile("Raw Data/Arthropod_data.xlsx", "Malaise")
malcount <- mal %>% group_by(order) %>% summarise(abun = sum(as.numeric(quantity), na.rm = TRUE))
View(malcount)
write.csv(malcount, "malcount.csv")
write.csv(pitcount, "pitcount.csv")
write.csv(active, "active.csv")
pits %>% filter(family == "Formicidae") %>% sum(Quantity)
pits %>% filter(family == "Formicidae") %>% sum$quantity
pits %>% filter(family == "Formicidae") %>% sum(quantity)
View(pits)
pits %>% filter(family == "Formicidae") %>% sum(.$quantity)
pits %>% filter(family == "Formicidae") %>% sum(.$quantity, na.rm = TRUE)
%>% sum(.$quantity, na.rm = TRUE)
ants <- pits %?% filter(family == "Formicidae")
ants <- pits %>% filter(family == "Formicidae")
sum(ants$quantity)
